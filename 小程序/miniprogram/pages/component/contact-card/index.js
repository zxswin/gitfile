"use strict";
Component({
    data: {
        markData: {
            position: 'center'
        },
        canvasParam: {
            width: '320px',
            height: '100%'
        }
    },
    observers: {},
    properties: {
        screenshotData: {
            type: Object,
            value: {
                orderList: [],
                totalPrice: 0,
                clearPrice: 0,
                clientInfo: {}
            }
        }
    },
    lifetimes: {
        ready: function () {
            this.createCanvas(this.data.screenshotData);
        }
    },
    methods: {
        createCanvas: function (screenshotData) {
            var _this = this;
            console.log('开始创建画布', screenshotData);
            var orderList = screenshotData.orderList;
            var clientInfo = screenshotData.clientInfo;
            var totalPrice = screenshotData.totalPrice;
            var clearPrice = screenshotData.clearPrice;
            var fearList = screenshotData.fearList;
            var couponList = screenshotData.couponList;
            var canvasHeight = 0;
            canvasHeight += 150;
            canvasHeight += orderList.length * 40;
            canvasHeight += (fearList.length + couponList.length) * 40;
            canvasHeight += 280;
            this.setData({
                'canvasParam.height': canvasHeight + 'px'
            });
            var ctx = wx.createCanvasContext('contentCanvas', this);
            var fontSize = 14;
            var lineHeight = 30;
            var startWidth = 10;
            var startHeight = 30;
            ctx.setFontSize(fontSize);
            ctx.setFillStyle('#fff');
            ctx.fillRect(0, 0, 320, canvasHeight);
            ctx.setFillStyle('#000');
            var packageInfoTitle = '收货信息';
            ctx.fillText(packageInfoTitle, startWidth, startHeight);
            ctx.fillText(packageInfoTitle, startWidth, startHeight);
            ctx.fillText(packageInfoTitle, startWidth, startHeight);
            ctx.beginPath();
            ctx.setLineWidth(2);
            ctx.setStrokeStyle('#000');
            ctx.setLineDash([10, 0], 0);
            ctx.moveTo(startWidth, startHeight + 15);
            ctx.lineTo(300, startHeight + 15);
            ctx.stroke();
            ctx.closePath();
            startHeight += lineHeight + 5;
            ctx.fillText("\u59D3\u540D\uFF1A" + clientInfo.name, startWidth, startHeight);
            startHeight += 25;
            ctx.fillText('收件地址：', startWidth, startHeight);
            startHeight += 25;
            var address = clientInfo.region + clientInfo.address;
            var maxAddress = 17;
            var addressLength = address.length;
            if (addressLength > maxAddress) {
                var firstAddress = address.substring(0, maxAddress + 1);
                ctx.fillText(firstAddress, startWidth, startHeight);
                startHeight += 25;
                var secondAddress = address.substring(maxAddress + 1);
                ctx.fillText(secondAddress, startWidth, startHeight);
                startHeight += 30;
            }
            else {
                ctx.fillText(address, startWidth, startHeight);
                startHeight += 30;
            }
            var orderListTitle = '订单列表：';
            ctx.fillText(orderListTitle, startWidth, startHeight);
            ctx.fillText(orderListTitle, startWidth, startHeight);
            ctx.fillText(orderListTitle, startWidth, startHeight);
            ctx.beginPath();
            ctx.setLineWidth(2);
            ctx.setStrokeStyle('#000');
            ctx.setLineDash([10, 0], 0);
            ctx.moveTo(startWidth, startHeight + 15);
            ctx.lineTo(300, startHeight + 15);
            ctx.stroke();
            ctx.closePath();
            startHeight += lineHeight + 15;
            orderList.forEach(function (item) {
                var text = item.name + "(" + item.standards + ")";
                ctx.fillText(text, startWidth, startHeight);
                var priceText = item.price + "\u5143 x " + item.amount + " ";
                ctx.fillText(priceText, 240, startHeight);
                startHeight += lineHeight;
            });
            ctx.beginPath();
            ctx.setLineWidth(2);
            ctx.setStrokeStyle('#000');
            ctx.setLineDash([10, 0], 0);
            ctx.moveTo(startWidth, startHeight - 10);
            ctx.lineTo(300, startHeight - 10);
            ctx.stroke();
            ctx.closePath();
            startHeight += 15;
            ctx.fillText('商品总计', startWidth, startHeight);
            var totalPrictText = "+ " + totalPrice + "\u5143";
            ctx.fillText(totalPrictText, 240, startHeight);
            ctx.fillText(totalPrictText, 240, startHeight);
            ctx.fillText(totalPrictText, 240, startHeight);
            startHeight += 25;
            fearList.forEach(function (item) {
                var fearType = item.fearType;
                var fearValue = "+ " + item.fearValue + " \u5143";
                ctx.fillText(fearType, startWidth, startHeight);
                ctx.fillText(fearValue, 240, startHeight);
                ctx.fillText(fearValue, 240, startHeight);
                ctx.fillText(fearValue, 240, startHeight);
                startHeight += 25;
            });
            var couponPrice = 0;
            couponList.forEach(function (item) {
                couponPrice += item.couponValue;
            });
            ctx.fillText('优惠减免', startWidth, startHeight);
            var deductionText = "- " + couponPrice + "\u5143";
            ctx.fillStyle = 'red';
            ctx.fillText(deductionText, 240, startHeight);
            ctx.fillText(deductionText, 240, startHeight);
            ctx.fillText(deductionText, 240, startHeight);
            startHeight += 25;
            ctx.beginPath();
            ctx.setLineWidth(2);
            ctx.setStrokeStyle('#000');
            ctx.setLineDash([10, 0], 0);
            ctx.moveTo(startWidth, startHeight - 10);
            ctx.lineTo(300, startHeight - 10);
            ctx.stroke();
            ctx.closePath();
            startHeight += 15;
            ctx.fillStyle = '#000';
            ctx.fillText('结算价格', startWidth, startHeight);
            ctx.fillText('结算价格', startWidth, startHeight);
            ctx.fillText('结算价格', startWidth, startHeight);
            var clearPrictText = "  " + clearPrice + "\u5143";
            ctx.fillText(clearPrictText, 240, startHeight);
            ctx.fillText(clearPrictText, 240, startHeight);
            ctx.fillText(clearPrictText, 240, startHeight);
            startHeight += 25;
            ctx.fillText('订单备注', startWidth, startHeight);
            var remarkText = "" + clientInfo.remark;
            ctx.fillText(remarkText, 90, startHeight);
            startHeight += 25;
            var tipText = '保存截图扫描图片中的二维码添加我吧';
            ctx.fillText(tipText, startWidth, startHeight);
            startHeight += 10;
            var imageResource = '../../../src/img/sqrcode.jpg';
            ctx.drawImage(imageResource, 0, startHeight, 100, 100);
            ctx.draw(false, function (res) {
                console.log('drawing', res);
                setTimeout(function () {
                    console.log('延迟200毫秒执行');
                    wx.canvasToTempFilePath({
                        canvasId: 'contentCanvas',
                        quality: 1,
                        fileType: 'jpg',
                        canvas: '',
                        success: function (res) {
                            var tempFilePath = res.tempFilePath;
                            console.log('tempFilePath', tempFilePath, _this);
                            _this.setData({
                                tempFilePath: tempFilePath
                            });
                        },
                        fail: function (res) {
                            console.log('fail', res);
                        }
                    }, _this);
                }, 200);
            });
        },
        saveImage: function () {
            console.log('tempFilePathimg', this.data.tempFilePath);
            var filePath = this.data.tempFilePath;
            wx.showModal({
                title: '提示',
                content: '把订单明细图片保存到手机相册',
                success: function (res) {
                    if (res.confirm) {
                        console.log('用户点击确定');
                        wx.saveImageToPhotosAlbum({
                            filePath: filePath,
                            success: function (res) {
                                console.log('图片保存成功', res);
                                wx.setClipboardData({
                                    data: 'Moriseafood',
                                    success: function (res) {
                                        console.log(res);
                                        var tip = '订单图片已保存,微信号Moriseafood已经复制快去添加我吧!';
                                        wx.showToast({
                                            title: tip,
                                            icon: 'none',
                                            duration: 5000
                                        });
                                    }
                                });
                            }
                        });
                        var shopList = [];
                        try {
                            shopList = wx.getStorageSync('shopList');
                        }
                        catch (e) {
                            console.log('shop-car全局购物车缓存获取失败');
                            shopList = this.data.shopCarData.shopList;
                        }
                        shopList.length = 0;
                        console.log('清空购物车', shopList);
                        try {
                            wx.setStorageSync('shopList', shopList);
                        }
                        catch (e) {
                            console.log('shop-car全局购物车缓存设置失败');
                        }
                    }
                    else if (res.cancel) {
                        console.log('用户点击取消');
                    }
                }
            });
        },
        closeMask: function () {
            console.log('遮罩层被点击了');
            this.triggerEvent('close', { close: true });
        },
        contentClick: function () {
            console.log('阻止点击主内容取事件冒泡');
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsU0FBUyxDQUFDO0lBQ1IsSUFBSSxFQUFFO1FBRUosUUFBUSxFQUFFO1lBQ1IsUUFBUSxFQUFFLFFBQVE7U0FDbkI7UUFDRCxXQUFXLEVBQUU7WUFDWCxLQUFLLEVBQUUsT0FBTztZQUNkLE1BQU0sRUFBRSxNQUFNO1NBQ2Y7S0FDRjtJQUVELFNBQVMsRUFBRSxFQUFFO0lBRWIsVUFBVSxFQUFFO1FBRVYsY0FBYyxFQUFFO1lBQ2QsSUFBSSxFQUFFLE1BQU07WUFDWixLQUFLLEVBQUU7Z0JBRUwsU0FBUyxFQUFFLEVBQUU7Z0JBRWIsVUFBVSxFQUFFLENBQUM7Z0JBRWIsVUFBVSxFQUFFLENBQUM7Z0JBRWIsVUFBVSxFQUFFLEVBQUU7YUFDZjtTQUNGO0tBQ0Y7SUFHRCxTQUFTLEVBQUU7UUFDVCxLQUFLLEVBQUU7WUFDTCxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDOUMsQ0FBQztLQUNGO0lBRUQsT0FBTyxFQUFFO1FBRVAsWUFBWSxZQUFDLGNBQWM7WUFBM0IsaUJBNk9DO1lBNU9DLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1lBR3RDLElBQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxTQUFTLENBQUM7WUFFM0MsSUFBTSxVQUFVLEdBQUcsY0FBYyxDQUFDLFVBQVUsQ0FBQztZQUU3QyxJQUFNLFVBQVUsR0FBRyxjQUFjLENBQUMsVUFBVSxDQUFDO1lBRTdDLElBQU0sVUFBVSxHQUFHLGNBQWMsQ0FBQyxVQUFVLENBQUM7WUFFN0MsSUFBTSxRQUFRLEdBQUcsY0FBYyxDQUFDLFFBQVEsQ0FBQztZQUV6QyxJQUFNLFVBQVUsR0FBRyxjQUFjLENBQUMsVUFBVSxDQUFDO1lBRzdDLElBQUksWUFBWSxHQUFHLENBQUMsQ0FBQztZQUdy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IHtcclxuICAgIC8qKiDpga7nvannu4Tku7blhaXlj4Lnm7jlhbPmlbDmja4gICovXHJcbiAgICBtYXJrRGF0YToge1xyXG4gICAgICBwb3NpdGlvbjogJ2NlbnRlcidcclxuICAgIH0sXHJcbiAgICBjYW52YXNQYXJhbToge1xyXG4gICAgICB3aWR0aDogJzMyMHB4JyxcclxuICAgICAgaGVpZ2h0OiAnMTAwJSdcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBvYnNlcnZlcnM6IHt9LFxyXG5cclxuICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAvKiog55Sf5oiQ5oiq5Zu+5omA6ZyA6KaB55qE5pWw5o2uICAqL1xyXG4gICAgc2NyZWVuc2hvdERhdGE6IHtcclxuICAgICAgdHlwZTogT2JqZWN0LFxyXG4gICAgICB2YWx1ZToge1xyXG4gICAgICAgIC8qKiDorqLljZXliJfooaggICovXHJcbiAgICAgICAgb3JkZXJMaXN0OiBbXSxcclxuICAgICAgICAvKiog5ZWG5ZOB5oC75Lu3ICAqL1xyXG4gICAgICAgIHRvdGFsUHJpY2U6IDAsXHJcbiAgICAgICAgLyoqIOe7k+eul+S7t+agvCAgKi9cclxuICAgICAgICBjbGVhclByaWNlOiAwLFxyXG4gICAgICAgIC8qKiDlrqLmiLfkv6Hmga8gICovXHJcbiAgICAgICAgY2xpZW50SW5mbzoge31cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKiDnu4Tku7bnmoTnlJ/lkb3lkajmnJ8gICovXHJcbiAgbGlmZXRpbWVzOiB7XHJcbiAgICByZWFkeTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHRoaXMuY3JlYXRlQ2FudmFzKHRoaXMuZGF0YS5zY3JlZW5zaG90RGF0YSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgbWV0aG9kczoge1xyXG4gICAgLyoqIOWIm+W7uueUu+W4gyAgKi9cclxuICAgIGNyZWF0ZUNhbnZhcyhzY3JlZW5zaG90RGF0YSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5byA5aeL5Yib5bu655S75biDJywgc2NyZWVuc2hvdERhdGEpO1xyXG5cclxuICAgICAgLyoqIOiuouWNleWIl+ihqCAgKi9cclxuICAgICAgY29uc3Qgb3JkZXJMaXN0ID0gc2NyZWVuc2hvdERhdGEub3JkZXJMaXN0O1xyXG4gICAgICAvKiog5a6i5oi35L+h5oGvICAqL1xyXG4gICAgICBjb25zdCBjbGllbnRJbmZvID0gc2NyZWVuc2hvdERhdGEuY2xpZW50SW5mbztcclxuICAgICAgLyoqIOWVhuWTgeaAu+S7tyAgKi9cclxuICAgICAgY29uc3QgdG90YWxQcmljZSA9IHNjcmVlbnNob3REYXRhLnRvdGFsUHJpY2U7XHJcbiAgICAgIC8qKiAg57uT566X5Lu35qC8ICAqL1xyXG4gICAgICBjb25zdCBjbGVhclByaWNlID0gc2NyZWVuc2hvdERhdGEuY2xlYXJQcmljZTtcclxuICAgICAgLyoqIOi0ueeUqOWIl+ihqCAgKi9cclxuICAgICAgY29uc3QgZmVhckxpc3QgPSBzY3JlZW5zaG90RGF0YS5mZWFyTGlzdDtcclxuICAgICAgLyoqIOS8mOaDoOWIuOWIl+ihqCAgKi9cclxuICAgICAgY29uc3QgY291cG9uTGlzdCA9IHNjcmVlbnNob3REYXRhLmNvdXBvbkxpc3Q7XHJcblxyXG4gICAgICAvLyDmoLnmja7orqLljZXmlbDmja7ph43nva7nlLvluIPnmoTpq5jluqZcclxuICAgICAgbGV0IGNhbnZhc0hlaWdodCA9IDA7XHJcblxyXG4gICAgICAvLyDlp5PlkI3lj4rmlLbotKflnLDlnYDpg6jliIbnmoTpq5jluqborqHnrpdcclxuICAgICAgY2FudmFzSGVpZ2h0ICs9IDE1MDtcclxuXHJcbiAgICAgIC8vIOiuouWNlemDqOWIhueahOmrmOW6puiuoeeul1xyXG4gICAgICBjYW52YXNIZWlnaHQgKz0gb3JkZXJMaXN0Lmxlbmd0aCAqIDQwO1xyXG5cclxuICAgICAgLy8g5ZWG5ZOB5Lu35qC86K6h566X6YOo5YiG55qE6auY5bqm6K6h566XXHJcbiAgICAgIGNhbnZhc0hlaWdodCArPSAoZmVhckxpc3QubGVuZ3RoICsgY291cG9uTGlzdC5sZW5ndGgpICogNDA7XHJcblxyXG4gICAgICAvLyDkuoznu7TnoIHpg6jliIbpq5jluqborqHnrpdcclxuICAgICAgY2FudmFzSGVpZ2h0ICs9IDI4MDtcclxuXHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgJ2NhbnZhc1BhcmFtLmhlaWdodCc6IGNhbnZhc0hlaWdodCArICdweCdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBjdHggPSB3eC5jcmVhdGVDYW52YXNDb250ZXh0KCdjb250ZW50Q2FudmFzJywgdGhpcyk7XHJcblxyXG4gICAgICBjb25zdCBmb250U2l6ZSA9IDE0O1xyXG4gICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gMzA7XHJcbiAgICAgIGxldCBzdGFydFdpZHRoID0gMTA7XHJcbiAgICAgIGxldCBzdGFydEhlaWdodCA9IDMwO1xyXG4gICAgICBjdHguc2V0Rm9udFNpemUoZm9udFNpemUpO1xyXG5cclxuICAgICAgY3R4LnNldEZpbGxTdHlsZSgnI2ZmZicpO1xyXG5cclxuICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIDMyMCwgY2FudmFzSGVpZ2h0KTtcclxuXHJcbiAgICAgIGN0eC5zZXRGaWxsU3R5bGUoJyMwMDAnKTtcclxuXHJcbiAgICAgIC8vIOaUtui0p+S/oeaBr1xyXG4gICAgICBjb25zdCBwYWNrYWdlSW5mb1RpdGxlID0gJ+aUtui0p+S/oeaBryc7XHJcbiAgICAgIC8vIOWtl+S9k+WKoOeyl1xyXG4gICAgICBjdHguZmlsbFRleHQocGFja2FnZUluZm9UaXRsZSwgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjdHguZmlsbFRleHQocGFja2FnZUluZm9UaXRsZSwgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjdHguZmlsbFRleHQocGFja2FnZUluZm9UaXRsZSwgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG5cclxuICAgICAgLy8g57uY5Yi25LiL5YiS57q/XHJcbiAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgY3R4LnNldExpbmVXaWR0aCgyKTtcclxuICAgICAgY3R4LnNldFN0cm9rZVN0eWxlKCcjMDAwJyk7XHJcbiAgICAgIGN0eC5zZXRMaW5lRGFzaChbMTAsIDBdLCAwKTsgLy8g6Jma57q/57uY5Yi2XHJcblxyXG4gICAgICBjdHgubW92ZVRvKHN0YXJ0V2lkdGgsIHN0YXJ0SGVpZ2h0ICsgMTUpO1xyXG4gICAgICBjdHgubGluZVRvKDMwMCwgc3RhcnRIZWlnaHQgKyAxNSk7XHJcbiAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgc3RhcnRIZWlnaHQgKz0gbGluZUhlaWdodCArIDU7XHJcblxyXG4gICAgICAvLyDlp5PlkI1cclxuICAgICAgY3R4LmZpbGxUZXh0KGDlp5PlkI3vvJoke2NsaWVudEluZm8ubmFtZX1gLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIHN0YXJ0SGVpZ2h0ICs9IDI1O1xyXG4gICAgICBjdHguZmlsbFRleHQoJ+aUtuS7tuWcsOWdgO+8micsIHN0YXJ0V2lkdGgsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgc3RhcnRIZWlnaHQgKz0gMjU7XHJcblxyXG4gICAgICAvLyDmlLbotKflnLDlnYDlpoLmnpzlpKrplb/kuobpnIDopoHov5vooYzmi4bliIZcclxuICAgICAgY29uc3QgYWRkcmVzcyA9IGNsaWVudEluZm8ucmVnaW9uICsgY2xpZW50SW5mby5hZGRyZXNzO1xyXG4gICAgICAvLyDmr4/kuIDooYzmnIDlpJrlsZXnpLrnmoTlrZfkvZPkuKrmlbBcclxuICAgICAgY29uc3QgbWF4QWRkcmVzcyA9IDE3O1xyXG4gICAgICBjb25zdCBhZGRyZXNzTGVuZ3RoID0gYWRkcmVzcy5sZW5ndGg7XHJcblxyXG4gICAgICBpZiAoYWRkcmVzc0xlbmd0aCA+IG1heEFkZHJlc3MpIHtcclxuICAgICAgICBjb25zdCBmaXJzdEFkZHJlc3MgPSBhZGRyZXNzLnN1YnN0cmluZygwLCBtYXhBZGRyZXNzICsgMSk7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGZpcnN0QWRkcmVzcywgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICAgIHN0YXJ0SGVpZ2h0ICs9IDI1O1xyXG5cclxuICAgICAgICBjb25zdCBzZWNvbmRBZGRyZXNzID0gYWRkcmVzcy5zdWJzdHJpbmcobWF4QWRkcmVzcyArIDEpO1xyXG4gICAgICAgIGN0eC5maWxsVGV4dChzZWNvbmRBZGRyZXNzLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgICAgc3RhcnRIZWlnaHQgKz0gMzA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGFkZHJlc3MsIHN0YXJ0V2lkdGgsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgICBzdGFydEhlaWdodCArPSAzMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g6K6i5Y2V5YiX6KGoXHJcbiAgICAgIGNvbnN0IG9yZGVyTGlzdFRpdGxlID0gJ+iuouWNleWIl+ihqO+8mic7XHJcbiAgICAgIC8vIOWtl+S9k+WKoOeyl1xyXG4gICAgICBjdHguZmlsbFRleHQob3JkZXJMaXN0VGl0bGUsIHN0YXJ0V2lkdGgsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgY3R4LmZpbGxUZXh0KG9yZGVyTGlzdFRpdGxlLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGN0eC5maWxsVGV4dChvcmRlckxpc3RUaXRsZSwgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG5cclxuICAgICAgLy8g57uY5Yi25LiL5YiS57q/XHJcbiAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgY3R4LnNldExpbmVXaWR0aCgyKTtcclxuICAgICAgY3R4LnNldFN0cm9rZVN0eWxlKCcjMDAwJyk7XHJcbiAgICAgIGN0eC5zZXRMaW5lRGFzaChbMTAsIDBdLCAwKTtcclxuXHJcbiAgICAgIGN0eC5tb3ZlVG8oc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQgKyAxNSk7XHJcbiAgICAgIGN0eC5saW5lVG8oMzAwLCBzdGFydEhlaWdodCArIDE1KTtcclxuICAgICAgY3R4LnN0cm9rZSgpO1xyXG4gICAgICBjdHguY2xvc2VQYXRoKCk7XHJcblxyXG4gICAgICBzdGFydEhlaWdodCArPSBsaW5lSGVpZ2h0ICsgMTU7XHJcblxyXG4gICAgICBvcmRlckxpc3QuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAvLyDkuqflk4Hlj4rop4TmoLxcclxuICAgICAgICBjb25zdCB0ZXh0ID0gYCR7aXRlbS5uYW1lfSgke2l0ZW0uc3RhbmRhcmRzfSlgO1xyXG4gICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcblxyXG4gICAgICAgIC8vIOS7t+agvOWPiuaVsOmHj1xyXG4gICAgICAgIGNvbnN0IHByaWNlVGV4dCA9IGAke2l0ZW0ucHJpY2V95YWDIHggJHtpdGVtLmFtb3VudH0gYDtcclxuICAgICAgICBjdHguZmlsbFRleHQocHJpY2VUZXh0LCAyNDAsIHN0YXJ0SGVpZ2h0KTtcclxuXHJcbiAgICAgICAgc3RhcnRIZWlnaHQgKz0gbGluZUhlaWdodDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyDnu5jliLbkuIvliJLnur9cclxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICBjdHguc2V0TGluZVdpZHRoKDIpO1xyXG4gICAgICBjdHguc2V0U3Ryb2tlU3R5bGUoJyMwMDAnKTtcclxuICAgICAgY3R4LnNldExpbmVEYXNoKFsxMCwgMF0sIDApOyAvLyDnu5jliLbomZrnur9cclxuICAgICAgY3R4Lm1vdmVUbyhzdGFydFdpZHRoLCBzdGFydEhlaWdodCAtIDEwKTtcclxuICAgICAgY3R4LmxpbmVUbygzMDAsIHN0YXJ0SGVpZ2h0IC0gMTApO1xyXG4gICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuXHJcbiAgICAgIHN0YXJ0SGVpZ2h0ICs9IDE1O1xyXG4gICAgICAvLyDorqHnrpflh7rmgLvku7fmoLxcclxuICAgICAgY3R4LmZpbGxUZXh0KCfllYblk4HmgLvorqEnLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGNvbnN0IHRvdGFsUHJpY3RUZXh0ID0gYCsgJHt0b3RhbFByaWNlfeWFg2A7XHJcbiAgICAgIGN0eC5maWxsVGV4dCh0b3RhbFByaWN0VGV4dCwgMjQwLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGN0eC5maWxsVGV4dCh0b3RhbFByaWN0VGV4dCwgMjQwLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGN0eC5maWxsVGV4dCh0b3RhbFByaWN0VGV4dCwgMjQwLCBzdGFydEhlaWdodCk7XHJcblxyXG4gICAgICBzdGFydEhlaWdodCArPSAyNTtcclxuXHJcbiAgICAgIGZlYXJMaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgY29uc3QgZmVhclR5cGUgPSBpdGVtLmZlYXJUeXBlO1xyXG4gICAgICAgIGNvbnN0IGZlYXJWYWx1ZSA9IGArICR7aXRlbS5mZWFyVmFsdWV9IOWFg2A7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGZlYXJUeXBlLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGZlYXJWYWx1ZSwgMjQwLCBzdGFydEhlaWdodCk7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGZlYXJWYWx1ZSwgMjQwLCBzdGFydEhlaWdodCk7XHJcbiAgICAgICAgY3R4LmZpbGxUZXh0KGZlYXJWYWx1ZSwgMjQwLCBzdGFydEhlaWdodCk7XHJcblxyXG4gICAgICAgIHN0YXJ0SGVpZ2h0ICs9IDI1O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIOS8mOaDoOWHj+WFjVxyXG4gICAgICBsZXQgY291cG9uUHJpY2UgPSAwO1xyXG4gICAgICBjb3Vwb25MaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgY291cG9uUHJpY2UgKz0gaXRlbS5jb3Vwb25WYWx1ZTtcclxuICAgICAgfSk7XHJcbiAgICAgIGN0eC5maWxsVGV4dCgn5LyY5oOg5YeP5YWNJywgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjb25zdCBkZWR1Y3Rpb25UZXh0ID0gYC0gJHtjb3Vwb25QcmljZX3lhYNgO1xyXG4gICAgICBjdHguZmlsbFN0eWxlID0gJ3JlZCc7IC8vIOiuvue9ruWtl+S9k+minOiJslxyXG4gICAgICBjdHguZmlsbFRleHQoZGVkdWN0aW9uVGV4dCwgMjQwLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGN0eC5maWxsVGV4dChkZWR1Y3Rpb25UZXh0LCAyNDAsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgY3R4LmZpbGxUZXh0KGRlZHVjdGlvblRleHQsIDI0MCwgc3RhcnRIZWlnaHQpO1xyXG5cclxuICAgICAgc3RhcnRIZWlnaHQgKz0gMjU7XHJcblxyXG4gICAgICAvLyDnu5jliLblrp7nur9cclxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICBjdHguc2V0TGluZVdpZHRoKDIpO1xyXG4gICAgICBjdHguc2V0U3Ryb2tlU3R5bGUoJyMwMDAnKTtcclxuICAgICAgY3R4LnNldExpbmVEYXNoKFsxMCwgMF0sIDApOyAvLyDnu5jliLbomZrnur9cclxuICAgICAgY3R4Lm1vdmVUbyhzdGFydFdpZHRoLCBzdGFydEhlaWdodCAtIDEwKTtcclxuICAgICAgY3R4LmxpbmVUbygzMDAsIHN0YXJ0SGVpZ2h0IC0gMTApO1xyXG4gICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuXHJcbiAgICAgIHN0YXJ0SGVpZ2h0ICs9IDE1O1xyXG5cclxuICAgICAgLy8g57uT566X5Lu35qC8XHJcbiAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzAwMCc7XHJcbiAgICAgIGN0eC5maWxsVGV4dCgn57uT566X5Lu35qC8Jywgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjdHguZmlsbFRleHQoJ+e7k+eul+S7t+agvCcsIHN0YXJ0V2lkdGgsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgY3R4LmZpbGxUZXh0KCfnu5Pnrpfku7fmoLwnLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcblxyXG4gICAgICBjb25zdCBjbGVhclByaWN0VGV4dCA9IGAgICR7Y2xlYXJQcmljZX3lhYNgO1xyXG4gICAgICBjdHguZmlsbFRleHQoY2xlYXJQcmljdFRleHQsIDI0MCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjdHguZmlsbFRleHQoY2xlYXJQcmljdFRleHQsIDI0MCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBjdHguZmlsbFRleHQoY2xlYXJQcmljdFRleHQsIDI0MCwgc3RhcnRIZWlnaHQpO1xyXG5cclxuICAgICAgc3RhcnRIZWlnaHQgKz0gMjU7XHJcblxyXG4gICAgICAvLyDorqLljZXlpIfms6jkv6Hmga9cclxuICAgICAgY3R4LmZpbGxUZXh0KCforqLljZXlpIfms6gnLCBzdGFydFdpZHRoLCBzdGFydEhlaWdodCk7XHJcbiAgICAgIGNvbnN0IHJlbWFya1RleHQgPSBgJHtjbGllbnRJbmZvLnJlbWFya31gO1xyXG4gICAgICBjdHguZmlsbFRleHQocmVtYXJrVGV4dCwgOTAsIHN0YXJ0SGVpZ2h0KTtcclxuICAgICAgc3RhcnRIZWlnaHQgKz0gMjU7XHJcblxyXG4gICAgICAvLyDkv53lrZjorqLljZXmiKrlm77lubbmiavmj4/lm77niYfkuK3nmoTkuoznu7TnoIHmt7vliqDmiJHkuLrlpb3lj4vlubbmiororqLljZXmiKrlm77lj5HnlJ/nu5nmiJHlkKdcclxuICAgICAgY29uc3QgdGlwVGV4dCA9ICfkv53lrZjmiKrlm77miavmj4/lm77niYfkuK3nmoTkuoznu7TnoIHmt7vliqDmiJHlkKcnO1xyXG4gICAgICBjdHguZmlsbFRleHQodGlwVGV4dCwgc3RhcnRXaWR0aCwgc3RhcnRIZWlnaHQpO1xyXG4gICAgICBzdGFydEhlaWdodCArPSAxMDtcclxuXHJcbiAgICAgIC8vIOe7mOWItuS6jOe7tOeggeWbvueJhyjnu5jliLblm77lg4/liLDnlLvluIMpXHJcbiAgICAgIGNvbnN0IGltYWdlUmVzb3VyY2UgPSAnLi4vLi4vLi4vc3JjL2ltZy9zcXJjb2RlLmpwZyc7XHJcbiAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2VSZXNvdXJjZSwgMCwgc3RhcnRIZWlnaHQsIDEwMCwgMTAwKTtcclxuXHJcbiAgICAgIGN0eC5kcmF3KGZhbHNlLCByZXMgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdkcmF3aW5nJywgcmVzKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygn5bu26L+fMjAw5q+r56eS5omn6KGMJyk7XHJcbiAgICAgICAgICB3eC5jYW52YXNUb1RlbXBGaWxlUGF0aChcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGNhbnZhc0lkOiAnY29udGVudENhbnZhcycsXHJcbiAgICAgICAgICAgICAgcXVhbGl0eTogMSxcclxuICAgICAgICAgICAgICBmaWxlVHlwZTogJ2pwZycsXHJcbiAgICAgICAgICAgICAgY2FudmFzOiAnJyxcclxuICAgICAgICAgICAgICBzdWNjZXNzOiByZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGVtcEZpbGVQYXRoID0gcmVzLnRlbXBGaWxlUGF0aDtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0ZW1wRmlsZVBhdGgnLCB0ZW1wRmlsZVBhdGgsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgICAgdGVtcEZpbGVQYXRoXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGZhaWw6IHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZmFpbCcsIHJlcyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0sIDIwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8qKiDngrnlh7vkuobkv53lrZjlm77niYfmjInpkq4gICovXHJcbiAgICBzYXZlSW1hZ2UoKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCd0ZW1wRmlsZVBhdGhpbWcnLCB0aGlzLmRhdGEudGVtcEZpbGVQYXRoKTtcclxuXHJcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gdGhpcy5kYXRhLnRlbXBGaWxlUGF0aDtcclxuXHJcbiAgICAgIHd4LnNob3dNb2RhbCh7XHJcbiAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxyXG4gICAgICAgIGNvbnRlbnQ6ICfmiororqLljZXmmI7nu4blm77niYfkv53lrZjliLDmiYvmnLrnm7jlhownLFxyXG4gICAgICAgIHN1Y2Nlc3MocmVzKSB7XHJcbiAgICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+eUqOaIt+eCueWHu+ehruWumicpO1xyXG4gICAgICAgICAgICB3eC5zYXZlSW1hZ2VUb1Bob3Rvc0FsYnVtKHtcclxuICAgICAgICAgICAgICBmaWxlUGF0aCxcclxuICAgICAgICAgICAgICBzdWNjZXNzKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+WbvueJh+S/neWtmOaIkOWKnycsIHJlcyk7XHJcbiAgICAgICAgICAgICAgICB3eC5zZXRDbGlwYm9hcmREYXRhKHtcclxuICAgICAgICAgICAgICAgICAgZGF0YTogJ01vcmlzZWFmb29kJyxcclxuICAgICAgICAgICAgICAgICAgc3VjY2VzcyhyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOyAvLyBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGlwID1cclxuICAgICAgICAgICAgICAgICAgICAgICforqLljZXlm77niYflt7Lkv53lrZgs5b6u5L+h5Y+3TW9yaXNlYWZvb2Tlt7Lnu4/lpI3liLblv6vljrvmt7vliqDmiJHlkKchJztcclxuICAgICAgICAgICAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpcCxcclxuICAgICAgICAgICAgICAgICAgICAgIGljb246ICdub25lJyxcclxuICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAwXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyDmuIXnqbrotK3nianovaZcclxuICAgICAgICAgICAgbGV0IHNob3BMaXN0ID0gW107XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluWFqOWxgOi0reeJqei9pue8k+WtmOaVsOaNrlxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIHNob3BMaXN0ID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3Nob3BMaXN0Jyk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2hvcC1jYXLlhajlsYDotK3nianovabnvJPlrZjojrflj5blpLHotKUnKTtcclxuICAgICAgICAgICAgICBzaG9wTGlzdCA9IHRoaXMuZGF0YS5zaG9wQ2FyRGF0YS5zaG9wTGlzdDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKHNob3BMaXN0IGFzIGFueVtdKS5sZW5ndGggPSAwO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+a4heepuui0reeJqei9picsIHNob3BMaXN0KTtcclxuXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgLy8g5ZCM5q2l6K6+572u5YWo5bGA6LSt54mp6L2m57yT5a2YXHJcbiAgICAgICAgICAgICAgd3guc2V0U3RvcmFnZVN5bmMoJ3Nob3BMaXN0Jywgc2hvcExpc3QpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Nob3AtY2Fy5YWo5bGA6LSt54mp6L2m57yT5a2Y6K6+572u5aSx6LSlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmNhbmNlbCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn55So5oi354K55Ye75Y+W5raIJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvKiDpga7nvanlsYLooqvngrnlh7vkuoYgKi9cclxuICAgIGNsb3NlTWFzaygpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+mBrue9qeWxguiiq+eCueWHu+S6hicpO1xyXG4gICAgICAvLyDlj5HpgIHlhbPpl63kuovku7bliLDniLbnu4Tku7ZcclxuICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJywgeyBjbG9zZTogdHJ1ZSB9KTtcclxuICAgIH0sXHJcbiAgICAvKiog6Zi75q2i54K55Ye75Li75YaF5a655Y+W5LqL5Lu25YaS5rOhICAqL1xyXG4gICAgY29udGVudENsaWNrKCkge1xyXG4gICAgICBjb25zb2xlLmxvZygn6Zi75q2i54K55Ye75Li75YaF5a655Y+W5LqL5Lu25YaS5rOhJyk7XHJcbiAgICB9XHJcbiAgfVxyXG59KTtcclxuIl19