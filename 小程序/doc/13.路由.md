# 路由

## wx.switchTab(Object object)

```bash
## 跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面
## 跳转到 tabBar 页面，路径后面不能带参数
## 通过标签跳转
<navigator url="../lists/lists" open-type="switchTab">跳转到tab页面</navigator>

## 通过api跳转
wx.switchTab({
  url: "../lists/lists",
  success: function() {
    console.log("成功后的回调");
  },
  fail: function() {
    console.log("失败后的回调");
  },
  complete: function() {
    console.log("结束后的回调(成功，失败都会执行)");
  }
});
```

## wx.reLaunch(Object object)

```bash
## 关闭所有页面，打开到应用内的某个页面
## 切换后左上角会有一个回到主页的图标
wx.reLaunch({
  url: "../../indepages/pear/pear?id=1&name=pear",
  success: function() {
    console.log("成功后的回调");
  },
  fail: function() {
    console.log("失败后的回调");
  },
  complete: function() {
    console.log("结束后的回调(成功，失败都会执行)");
  }
});

## 在具体跳转的页面中获取携带过来的参数
Page({
  onLoad(option) {
    console.log("cat页面获取到的参数", option);
  }
});
```

## wx.redirectTo(Object object)

```bash
## 关闭当前页面，跳转到应用内的某个页面。但是不允许跳转到 tabbar 页面
## 左上角会出现主页图标
wx.redirectTo({
  url: "../../subpages/cat/cat?id=1&name=cat",
  success: function() {
    console.log("成功后的回调");
  },
  fail: function() {
    console.log("失败后的回调");
  },
  complete: function() {
    console.log("结束后的回调(成功，失败都会执行)");
  }
});
```

## wx.navigateTo(Object object)

```bash
## 保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面。使用 wx.navigateBack 可以返回到原页面。小程序中页面栈最多十层。
## 左上角出现返回箭头

wx.navigateTo({
  url: "../../subpages/cat/cat?id=1&name=cat",
  events: {
    // 为指定事件添加一个监听器，获取被打开页面传送到当前页面的数据
    acceptDataFromOpenedPage: function(data) {
      console.log(
        "监听目标页面通过acceptDataFromOpenedPage事情传递过来的数据",
        data
      );
    },
    someEvent: function(data) {
      console.log("监听目标页面通过someEvent事件传递过来的数据", data);
    }
  },
  success: function(res) {
    console.log("成功后的回调");
    // 通过eventChannel向被打开页面传送数据
    res.eventChannel.emit("acceptDataFromOpenerPage", { data: "test" });
  },
  fail: function() {
    console.log("失败后的回调");
  },
  complete: function() {
    console.log("结束后的回调(成功，失败都会执行)");
  }
});

## 目标页面
onLoad(option) {
  console.log("cat页面获取到的参数", option);
  const eventChannel = this.getOpenerEventChannel();
  eventChannel.emit("acceptDataFromOpenedPage", {
    data: "acceptDataFromOpenedPagetest"
  });
  eventChannel.emit("someEvent", { data: "someEventtest" });
  // 监听acceptDataFromOpenerPage事件，获取上一页面通过eventChannel传送到当前页面的数据
  eventChannel.on("acceptDataFromOpenerPage", function(data) {
    console.log("目标页面监听acceptDataFromOpenerPage事件", data);
  });
}

```

## wx.navigateBack(Object object)

```bash
## 关闭当前页面，返回上一页面或多级页面。可通过 getCurrentPages 获取当前的页面栈，决定需要返回几层。
## 调用 navigateTo 跳转时，调用该方法的页面会被加入堆栈，而 redirectTo 方法则不会。
// 此处是A页面
wx.navigateTo({
  url: 'B?id=1'
})

// 此处是B页面
wx.navigateTo({
  url: 'C?id=1'
})

// 在C页面内 navigateBack，将返回A页面
wx.navigateBack({
  delta: 2
})
```

## EventChannel

```bash
## 页面间事件通信通道
## 触发一个事件
EventChannel.emit(string eventName, any args)

## 取消监听一个事件。给出第二个参数时，只取消给出的监听函数，否则取消所有监听函数
EventChannel.off(string eventName, function fn)

## 持续监听一个事件
EventChannel.on(string eventName, function fn)

## 监听一个事件一次，触发后失效
EventChannel.once(string eventName, function fn)
```
