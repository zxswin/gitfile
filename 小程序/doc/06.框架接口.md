# 框架接口

## App() 注册小程序

```bash
## App() 必须在 app.js 中调用，必须调用且只能调用一次。不然会出现无法预期的后果。
App({
  // 生命周期回调——监听小程序初始化
  onLaunch(options) {
    console.log("onLaunch", options);
  },
  onShow(options) {
    console.log("onShow", options);
  },
  onHide() {
    console.log("onHide");
  },
  onError(msg) {
    console.log(msg);
  },
  onPageNotFound(res) {
    // 如果是 tabbar 页面，请使用 wx.switchTab
    console.log("res", res);
    wx.redirectTo({
      url: "pages/lists/lists"
    });
  },
  globalData: "I am global data"
});

```

## getApp 获取到小程序全局唯一的 App 实例

```bash
// other.js
var appInstance = getApp()
console.log(appInstance.globalData) // I am global data
```

## Page

```bash
Page({
  // 页面的初始数据
  data: {
    text: "This is page data."
  },
  onLoad: function(options) {
    // 生命周期回调—监听页面加载
  },
  onReady: function() {
    // 生命周期回调—监听页面初次渲染完成
  },
  onShow: function() {
    // 生命周期回调—监听页面显示
  },
  onHide: function() {
    // 生命周期回调—监听页面隐藏
  },
  onUnload: function() {
    // 生命周期回调—监听页面卸载
  },
  onPullDownRefresh: function() {
    // 监听用户下拉动作
  },
  onReachBottom: function() {
    // 页面上拉触底事件的处理函数
  },
  onShareAppMessage: function () {
    // 用户点击右上角转发
  },
  onPageScroll: function() {
    // 页面滚动触发事件的处理函数
  },
  onResize: function() {
    // 页面尺寸改变时触发
  },
  onTabItemTap(item) {
    // 当前是 tab 页时，点击 tab 时触发
    console.log(item.index)
    console.log(item.pagePath)
    console.log(item.text)
  },
  // 自定义事件
  viewTap: function() {
    this.setData({
      text: 'Set some data for updating view.'
    }, function() {
      // this is setData callback
    })
  },

  // 自定义数据
  customData: {
    hi: 'MINA'
  }
})
```

## this.setData

```bash
## 不需要在 this.data 中预先定义
## 直接修改 this.data 而不调用 this.setData 是无法改变页面的状态的，还会造成数据不一致
```

## getCurrentPages()

```bash
## 获取当前页面栈。数组中第一个元素为首页，最后一个元素为当前页面
```
