# 对象的拷贝

- 浅拷贝的实现

```js
function sallowCopy(source) {
  // source 不是对象，而是【原始类型】的情况
  if (null == source || 'object' != typeof source) return source;

  // 其他情况都将 source 当作简单对象来处理
  var target = {};
  // for in 遍历 自身和原型链上所有的可枚举属性
  for (var key in source) {
    // hasOwnPropert只要在对象自身上，不管可不可枚举都返回true。
    if (source.hasOwnProperty(key)) {
      // 仅拷贝自身的属性
      target[key] = source[key];
    }
  }
  return target;
}
/*
这个浅拷贝会将source对象上的所有[可枚举属性]都拷贝到target对象上，不包括原型链上的属性。
*/
```

- 对象深拷贝的实现

```js
function deepClone(obj) {
  var copy;

  // 如果是 number, boolean, string, null and undefined
  if (null == obj || 'object' != typeof obj) return obj;

  // 如果是 Date
  if (obj instanceof Date) {
    copy = new Date();
    copy.setTime(obj.getTime());
    return copy;
  }

  // 如果是 Array
  if (obj instanceof Array) {
    copy = [];
    for (var i = 0, len = obj.length; i < len; i++) {
      copy[i] = deepClone(obj[i]); // 使用了递归
    }
    return copy;
  }

  // 如果是 Object
  if (obj instanceof Object) {
    copy = {};
    for (var attr in obj) {
      if (obj.hasOwnProperty(attr)) copy[attr] = deepClone(obj[attr]); // 使用了递归
    }
    return copy;
  }

  throw new Error("Unable to copy obj! Its type isn't supported.");
}
```

- 其他拷贝对象的方法

```js
/**
 * JSON.parse 和 JSON.stringify 实现对象深拷贝
 */
var cloneOfA = JSON.parse(JSON.stringify(a));

/**
 * Object.assign(target, ...sources)是ES6提供的浅拷贝方法
 */
Object.assign({}, 'abcd');
// Object {0: "a", 1: "b", 2: "c", 3: "d"}

/**
 * jQuery.extend 实现浅拷贝 和 深拷贝
 */

// 浅拷贝
var copiedObject = jQuery.extend({}, originalObject);
// 深拷贝
var copiedObject = jQuery.extend(true, {}, originalObject);
```

- Object.assign()

```js
/**
 * Object.assign()方法用于将所有可枚举属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。
 * Object.assign 方法只会拷贝源对象自身的并且可枚举的属性到目标对象。
 */
const target = { a: 1, b: 2 };
const source = { b: 4, c: 5 };

const returnedTarget = Object.assign(target, source);

console.log(target);
// expected output: Object { a: 1, b: 4, c: 5 }

console.log(returnedTarget);
// expected output: Object { a: 1, b: 4, c: 5 }
```
