## react 环境搭建

- 使用 create-react-app 初始化 react 项目

```bash

# 安装create-react-app
npm install -g create-react-app

# 创建支持typescript的项目
create-react-app my-app --typescript

# 安装eslint代码校验相关插件
npm install --save-dev eslint-config-react-app @typescript-eslint/eslint-plugin@2.x @typescript-eslint/parser@2.x babel-eslint@10.x eslint@6.x eslint-plugin-flowtype@3.x eslint-plugin-import@2.x eslint-plugin-jsx-a11y@6.x eslint-plugin-react@7.x eslint-plugin-react-hooks@1.x

# 添加路由插件 react-router-dom
npm install --save react-router-dom

# 安装路由插件
npm install --save react-router

# 安装mobx-react 用于状态管理
npm install --save mobx mobx-react

# 配置代理服务器地址
请在 package.json 中添加 proxy 字段，例如：
"proxy": "http://localhost:4000",

# 安装http-server
npm i -D http-server
"http": "http-server ./build -c-1"
```

- 目录结构说明

```bash
public/index.html 是页面模板;
src/index.tsx 是项目入口点。
只能在 public/index.html 中使用 public 中的文件
Webpack 只处理 src 中的文件

# public目录
将文件放入 public 文件夹，Webpack 将 不会 处理它。相反，它将被复制到构建文件夹中。
要引用 public 文件夹中的资源，需要使用名为 PUBLIC_URL 的特殊变量。

在 index.html 中，你可以像这样使用它：
<link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
```

- 可用的 Scripts 命令说明

```bash
# npm start
启动开发环境
# npm test
启动测试
# npm run build
构建生产版本
# npm run eject
输出配置文件以便能够自定义构建工具和配置选项
```

- 版本更新

```bash
create-react-app 是一个全局命令行实用程序，可用于创建新项目。
react-scripts 是生成项目中的开发依赖项（包括此项）
当你运行 create-react-app 时，它始终使用最新版本的 react-scripts 创建项目
```

- 分析 Bundle (包) 大小

```bash
# 安装 source-map-explorer
npm install --save source-map-explorer

# 在package.json文件中添加
"analyze": "source-map-explorer build/static/js/main.*",

# 运行分析脚本
npm run analyze
```

- 在开发环境中使用 HTTPS

```bash

# Windows (cmd.exe)
set HTTPS=true&&npm start（注意：缺少空格是故意的。）

# Windows (Powershell)
($env:HTTPS = "true") -and (npm start)

# Linux, macOS (Bash)
HTTPS=true npm start

```

- 样式文件的处理

```bash
Create React App 会压缩你的 CSS 并通过 Autoprefixer 自动添加浏览器前缀，因此你无需担心它。
```

## npm 安装源修改为淘宝

```bash
# npm 安装源设置为淘宝源
npm config set registry https://registry.npm.taobao.org

# 检查设置是否成功了
npm config get registry

# npm 安装源头还原为npm源
npm config set registry https://registry.npmjs.org/

# cnpm安装模块和npm安装的区别
cnpm安装的的2个模块，两者应该存在引用关系，正常名字模块是非正常名字模块的索引
npm安装下来就不存在这种情况了，因为只有一个正常名字模块。
尽管使用npm改成淘宝仓库，发现安装速度还是远远比cnpm慢（当模块比较多的时候）

```

- 创建最高效的 Brunch 生产版本

```bash
# 需要安装 uglify-js-brunch 插件：

# 如果使用 npm
npm install --save-dev uglify-js-brunch

# 如果使用 Yarn
yarn add --dev uglify-js-brunch

# 然后，为了创建生产构建版本，在 build 命令后添加 -p 参数：
brunch build -p

注意只有生产版本需要这样操作。
不要在开发环境中安装这个插件或者使用 -p 参数，
因为它会隐藏掉有用的 React 警告并使构建过程更慢。
```

- Browserify

```bash
# 为了创建最高效的 Browserify 生产版本，需要安装一些插件
# 如果使用 npm
npm install --save-dev bundle-collapser envify uglify-js uglifyify
# 如果使用 Yarn
yarn add --dev bundle-collapser envify uglify-js uglifyify

# 为了构建生产版本，务必添加这些设置指令 (这点很重要)：
envify 该插件确保正确的编译环境，全局安装（-g）。
uglifyify 该插件移除了开发接口。全局安装（-g）。
最后，以上结果都被输添加至 uglify-js 来得到整合

browserify ./index.js \
  -g [ envify --NODE_ENV production ] \
  -g uglifyify \
  -p bundle-collapser/plugin \
  | uglifyjs --compress --mangle > ./bundle.js
```
